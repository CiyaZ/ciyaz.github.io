# 数据卷和数据容器

我们知道Docker容器它仅仅是镜像的一个实例，需要持久化保存的数据不应该直接保存到Docker容器中，而应该保存到数据卷或数据容器中。

## 数据卷

数据卷是一个可供一个容器或多个容器使用的特殊目录，专门用来持久化数据。删除容器时，如果未指定删除数据卷，那么数据卷就不会被删除。

### 使用命令行参数挂载数据卷

我们可以在`docker run`时，使用参数`-v`挂载一个数据卷。

例子：
```
docker run -d -p 80:8080 -v /webapp sb-demo
```

我们使用`docker inspect`查看该容器详细信息时，可以在`Mounts`节点看到相关信息：
```
"Mounts": [
            {
                "Type": "volume",
                "Name": "4880884d7658fe8841d2aeb618c2e59621616150cc2c75d06d226fab4145cd25",
                "Source": "/var/lib/docker/volumes/4880884d7658fe8841d2aeb618c2e59621616150cc2c75d06d226fab4145cd25/_data",
                "Destination": "/webapp",
                "Driver": "local",
                "Mode": "",
                "RW": true,
                "Propagation": ""
            }
        ]
```

### 使用Dockerfile指令挂载数据卷

我们可以直接把创建数据卷的指令写在Dockerfile中，这样其他人使用我们制作的Docker镜像，就不需要再指定命令行参数了。

例子：
```
VOLUME /webapp
```

### 删除数据卷

删除容器时，使用`docker rm -v <容器ID>`可以删除容器和数据卷。

## 查看所有数据卷

```
docker volume ls
```

## 数据容器

数据卷一般不会供多个容器同时挂载，以免产生复杂的耦合关系，这种情况建议使用数据容器。数据容器就是个普通的容器，只不过它专门用来提供数据卷给其它容器挂载。

### 创建数据卷容器

我们通过`docker run -v`创建一个普通的带有数据卷的容器，在其它需要挂载该容器数据卷的地方使用`docker run`参数：

```
--volumes-from <容器ID>
```

### 如何删除数据卷容器

由于数据卷容器被多个容器依赖，删除容器时数据卷不会自动删除，因此删除数据卷容器时，我们通常会在删除最后一个依赖该数据卷的容器时，带上`-v`参数。
